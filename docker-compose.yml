version: '3.8'

services:
  livekit:
    image: livekit/livekit-server:latest
    container_name: livekit-server
    ports:
      - "7880:7880"  # API and WebSocket signaling
      - "7881:7881"  # TCP fallback
      - "7882:7882/udp"  # UDP for media traffic
    environment:
      # LIVEKIT_KEYS: "devkey: secret"  # Commented out to use livekit.yaml config
      LIVEKIT_PORT: "7880"
      LIVEKIT_BIND_ADDRESSES: "0.0.0.0:7880"
      LIVEKIT_TCP_PORT: "7881"
      LIVEKIT_TCP_BIND_ADDRESSES: "0.0.0.0:7881"
      LIVEKIT_UDP_PORT: "7882"
      LIVEKIT_UDP_BIND_ADDRESSES: "0.0.0.0:7882"
    volumes:
      - ./livekit.yaml:/config.yaml
    command: --config /config.yaml
    restart: unless-stopped
